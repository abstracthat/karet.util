!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("kefir.atom"),require("kefir"),require("infestines"),require("partial.lenses"),require("karet.lift"),require("react"),require("kefir.combines")):"function"==typeof define&&define.amd?define(["exports","kefir.atom","kefir","infestines","partial.lenses","karet.lift","react","kefir.combines"],n):n((t.karet=t.karet||{},t.karet.util={}),t.kefir.atom,t.Kefir,t.I,t.L,t.karet.lift,t.React,t.kefir.combines)}(this,function(t,n,r,e,i,o,a,u){"use strict";function c(t,n){for(var r=0,e=n.length;r<e;++r)t=n[r](t);return t}function f(t){for(var n=arguments.length,r=void 0,e=1;e<n;++e){var i=arguments[e];r?r.push(i):s(i)?r=[i]:t=i(t)}return r?at(t,J(r)):t}var l=function(t,n){return e.arityN(t+1,function(t){for(var r=arguments.length,e=Array(r>1?r-1:0),i=1;i<r;i++)e[i-1]=arguments[i];return o.combine(e,function(){for(var r=arguments.length,e=Array(r),i=0;i<r;i++)e[i]=arguments[i];return function(){return t[n].apply(t,e)}})})},s=function(t){return t instanceof r.Property},h=function(t){},p=function(t){return function(t){return t instanceof r.Observable}(t)?t:r.constant(t)},y=e.curry(function(t,n){return p(n).debounce(t)}),d=r.merge,m=e.curry(function(t,n){return p(n).delay(t)}),v=e.curry(function(t,n){return p(n).map(t)}),g=e.curry(function(t,n){return p(n).flatMap(e.pipe2U(t,p))}),M=e.curry(function(t,n){return p(n).flatMapConcat(e.pipe2U(t,p))}),b=e.curry(function(t,n){return p(n).flatMapErrors(e.pipe2U(t,p))}),k=e.curry(function(t,n){return p(n).flatMapLatest(e.pipe2U(t,p))}),w=e.curry(function(t,n,r){return p(r).scan(t,n)}),P=e.curry(r.interval),E=e.curry(r.later),A=r.never(),U=e.curry(function(t,n){return p(n).onAny((r=t,function(t){var n;return(n=r[t.type])&&n(t.value)}));var r}),_=e.curry(function(t,n){return p(n).sampledBy(t)}),q=e.curry(function(t,n){return p(n).skip(t)}),x=e.curry(function(t,n){return p(n).skipDuplicates(t)}),R=e.curry(function(t,n){return p(n).filter(t)}),I=e.curry(function(t,n){return p(n).take(t)}),C=e.curry(function(t,n){return p(n).takeErrors(t)}),D=e.curry(function(t,n){return p(n).takeUntilBy(t)}),S=function(t){return p(t).toProperty()},F=e.curry(function(t,n){return p(n).throttle(t)}),V=e.curry(r.fromEvents),B=e.curry(function(t,n){return p(n).toProperty(function(){return t})}),N=e.pipe2U(B(void 0),o.lift(h)),j=e.pipe2U(v,N),O=e.curry(function(t,n){return p(n).concat(p(t))}),W=x(e.identicalU),z=e.curry(function(t,n){return p(n).filter(function(n){return!t(n)})}),J=function(t){return o.combine([t],e.id)},L=e.inherit(function(t){r.Property.call(this),this.m=t,this.a=void 0},r.Property,{_onActivation:function(){var t=this,n=t.m;if(n){t.m=null;var r=n(),e=r.ready||r;t.a=r.abort,e.then(function(n){null!==t.a&&(t.a=null,t._emitValue(n),t._emitEnd())},function(n){null!==t.a&&(t.a=null,t._emitError(n),t._emitEnd())})}},_onDeactivation:function(){var t=this.a;t&&(this.a=null,this._emitEnd(),t())}}),K=function(t,n,r){return S(k(function(t){return t?n:r},t))},T=e.curry(K),G=e.curry(function(t,n){return K(t,void 0,n)}),H=e.arityN(2,K),Q=e.inherit(function(t){r.Property.call(this),this.d=t,this.s=this.i=0},r.Property,{_onActivation:function(){var t=this;t.i=requestAnimationFrame(function n(r){t.s||(t.s=r);var e=(r-t.s)/t.d;1<e&&(e=1),t._emitValue(e),e<1?t.i=requestAnimationFrame(n):t._emitEnd()})},_onDeactivation:function(){cancelAnimationFrame(this.i)}}),X="undefined"==typeof window?e.always(A):function(t){return new Q(t)},Y=u.combines,Z=r.Stream.prototype,$=e.inherit(function(){r.Stream.call(this)},r.Stream,{push:Z._emitValue,error:Z._emitError,end:Z._emitEnd}),tt=l(1,"push"),nt=l(1,"error"),rt=l(0,"end"),et=e.seq,it=e.seqPartial,ot=o.lift(e.curry(function(t,n){return void 0!==n&&t(n),n})),at=function(t,n){return S(k(function(n){return c(t,n)},n))},ut=function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return i.iso(function(t){return console.log.apply(console,n.concat([t]))||t},function(t){return console.log.apply(console,n.concat([t,"(set)"]))||t})},ct=a.createContext(e.object0),ft=ct.Provider,lt=ct.Consumer,st=(0,e.id)(function(t){return a.createElement(ft,{value:t.context},t.children)}),ht=(0,e.id)(function(t){return function(n){return a.createElement(lt,null,function(r){return t(n,r)})}}),pt=o.lift(function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return function(){for(var t=0,r=n.length;t<r;++t)e.isFunction(n[t])&&n[t].apply(n,arguments)}}),yt=function(t){return function(n){return n[t]()}},dt=yt("preventDefault"),mt=yt("stopPropagation"),vt=i.join(" ",[i.flatten,i.when(e.id)]),gt=o.lift(function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return vt(n)||void 0}),Mt=o.lift(JSON.parse),bt=o.lift(JSON.stringify),kt=o.lift(decodeURI),wt=o.lift(decodeURIComponent),Pt=o.lift(encodeURI),Et=o.lift(encodeURIComponent),At=o.lift(Math.abs),Ut=o.lift(Math.acos),_t=o.lift(Math.acosh),qt=o.lift(Math.asin),xt=o.lift(Math.asinh),Rt=o.lift(Math.atan),It=o.lift(Math.atan2),Ct=o.lift(Math.atanh),Dt=o.lift(Math.cbrt),St=o.lift(Math.ceil),Ft=o.lift(Math.clz32),Vt=o.lift(Math.cos),Bt=o.lift(Math.cosh),Nt=o.lift(Math.exp),jt=o.lift(Math.expm1),Ot=o.lift(Math.floor),Wt=o.lift(Math.fround),zt=o.lift(Math.hypot),Jt=o.lift(Math.imul),Lt=o.lift(Math.log),Kt=o.lift(Math.log10),Tt=o.lift(Math.log1p),Gt=o.lift(Math.log2),Ht=o.lift(Math.max),Qt=o.lift(Math.min),Xt=o.lift(Math.pow),Yt=o.lift(Math.round),Zt=o.lift(Math.sign),$t=o.lift(Math.sin),tn=o.lift(Math.sinh),nn=o.lift(Math.sqrt),rn=o.lift(Math.tan),en=o.lift(Math.tanh),on=o.lift(Math.trunc),an=o.lift(String.raw),un=e.curry(function(t,n){var r=o.combine([n],function(n){return t.set(n)});if(s(r))return r.toProperty(h)}),cn=l(1,"modify"),fn=l(1,"set"),ln=l(0,"remove"),sn=e.curry(function(t,r){return r instanceof n.AbstractMutable?s(J(t))?new n.Join(o.combine([t],function(t){return r.view(t)})):r.view(t):o.combine([t,r],i.get)}),hn=e.curry(function(t,n){var r=[];return f(n,w(function(e,i){var o=e.length,a=i.length;if(a===o)return e;for(var u=Math.min(o,a),c=e.slice(0,u),f=a;f<o;++f)r[f]._onDeactivation();for(var l=u;l<a;++l)c[l]=t(r[l]=sn(l,n),l);return r.length=a,c},[]),W)}),pn=e.curry(function(t,n,r){var e=new Map,o=i.get(t),a=function(t,n,r){return o(t)===r.id};return f(r,w(function(t,u){for(var c=u.length,f=t.length===c?t:Array(c),l=0;l<c;++l){var s=o(u[l]),h=e.get(s);void 0===h&&(e.set(s,h={}),h.id=s,h.hint=l,h.elem=n(h.view=sn(i.find(a,h),r),s)),f[l]!==h.elem&&(h.hint=l,f===t&&(f=f.slice(0)),f[l]=h.elem)}return f!==t&&e.forEach(function(t,n){f[t.hint]!==t.elem&&(t.view._onDeactivation(),e.delete(n))}),f},[]),W)});t.holding=n.holding,t.combine=o.combine,t.lift=o.lift,t.liftRec=o.liftRec,t.debounce=y,t.changes=function(t){return p(t).changes()},t.serially=function(t){return r.concat(t.map(p))},t.parallel=d,t.delay=m,t.mapValue=v,t.flatMapParallel=g,t.flatMapSerial=M,t.flatMapErrors=b,t.flatMapLatest=k,t.foldPast=w,t.interval=P,t.later=E,t.never=A,t.on=U,t.sampledBy=_,t.skipFirst=q,t.skipDuplicates=x,t.skipUnless=R,t.takeFirst=I,t.takeFirstErrors=C,t.takeUntilBy=D,t.toProperty=S,t.throttle=F,t.fromEvents=V,t.ignoreValues=function(t){return t.ignoreValues()},t.ignoreErrors=function(t){return t.ignoreErrors()},t.startWith=B,t.sink=N,t.consume=j,t.endWith=O,t.lazy=function(t){return S(k(t,S()))},t.skipIdenticals=W,t.skipWhen=z,t.template=J,t.fromPromise=function(t){return new L(t)},t.ifElse=T,t.unless=G,t.when=H,t.cond=function(t){for(var n=arguments.length,r=void 0;n--;){var e=arguments[n];r=1!==e.length?K(e[0],e[1],r):e[0]}return r},t.animationSpan=X,t.combines=Y,t.Bus=$,t.bus=function(){return new $},t.doPush=tt,t.doError=nt,t.doEnd=rt,t.seq=et,t.seqPartial=it,t.scope=function(t){return t()},t.tapPartial=ot,t.toPartial=function(t){return o.liftRec(e.arityN(t.length,function(){for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return r.every(e.isDefined)?t.apply(void 0,r):void 0}))},t.thru=f,t.through=function(){for(var t=arguments.length,n=Array(t),r=!0,e=0;e<t;++e){var i=n[e]=arguments[e];r&&(r=!s(i))}return r?function(t){return c(t,n)}:(n=J(n),function(t){return at(t,n)})},t.show=function(t){for(var n=arguments.length-1,r=Array(n),e=0;e<n;++e)r[e]=arguments[e];return sn(o.combine(r,ut),arguments[n])},t.onUnmount=function(t){return r.stream(e.always(t)).toProperty(e.always(void 0))},t.Context=st,t.withContext=ht,t.getProps=function(t){return function(n){var r=n.target;for(var e in t)t[e].set(r[e])}},t.setProps=function(t){var n=void 0,r=void 0;return function(e){r&&(n.offAny(r),n=r=null),e&&(r=function(t){switch(t.type){case"value":var i=t.value;for(var o in i)e[o]=i[o];break;case"error":throw t.value;case"end":n=r=null}},(n=J(t)).onAny(r))}},t.refTo=function(t){return function(n){null!==n&&t.set(n)}},t.actions=pt,t.preventDefault=dt,t.stopPropagation=mt,t.cns=gt,t.parse=Mt,t.stringify=bt,t.decodeURI=kt,t.decodeURIComponent=wt,t.encodeURI=Pt,t.encodeURIComponent=Et,t.abs=At,t.acos=Ut,t.acosh=_t,t.asin=qt,t.asinh=xt,t.atan=Rt,t.atan2=It,t.atanh=Ct,t.cbrt=Dt,t.ceil=St,t.clz32=Ft,t.cos=Vt,t.cosh=Bt,t.exp=Nt,t.expm1=jt,t.floor=Ot,t.fround=Wt,t.hypot=zt,t.imul=Jt,t.log=Lt,t.log10=Kt,t.log1p=Tt,t.log2=Gt,t.max=Ht,t.min=Qt,t.pow=Xt,t.round=Yt,t.sign=Zt,t.sin=$t,t.sinh=tn,t.sqrt=nn,t.tan=rn,t.tanh=en,t.trunc=on,t.string=an,t.atom=function(t){return new n.Atom(t)},t.variable=function(){return new n.Atom},t.molecule=function(t){return new n.Molecule(t)},t.set=un,t.doModify=cn,t.doSet=fn,t.doRemove=ln,t.view=sn,t.mapElems=hn,t.mapElemsWithIds=pn,Object.defineProperty(t,"__esModule",{value:!0})});
