!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("kefir.atom"),require("kefir"),require("infestines"),require("partial.lenses"),require("karet.lift"),require("karet"),require("react"),require("kefir.combines")):"function"==typeof define&&define.amd?define(["exports","kefir.atom","kefir","infestines","partial.lenses","karet.lift","karet","react","kefir.combines"],n):n((t.karet=t.karet||{},t.karet.util={}),t.kefir.atom,t.Kefir,t.I,t.L,t.karet.lift,t.karet,t.React,t.kefir.combines)}(this,function(t,r,c,f,h,a,o,u,n){"use strict";function e(t){for(var n=arguments.length,r=void 0,e=1;e<n;++e){var i=arguments[e];r?r.push(i):d(i)?r=[i]:t=i(t)}return r?ht(t,H(r)):t}function l(t,n){var r=n[t];if(null!=r)return Mt(t,r)}function i(t,n){for(var r in t)if(!f.identicalU(t[r],n[r]))return!1;return!0}function s(t,n,r){var e={};for(var i in n){var o=n[i];r(i)?e[i]=o:(e[i]=t[i]||(new c.Property).skipDuplicates(f.identicalU))._emitValue(o)}for(var a in t)if(!r(a)){var u=t[a];u!==e[a]&&u._emitEnd()}return e}var p=function(t){return t},m=function(t,i,n){return f.arityN(t+1,p(function(e){for(var t=arguments.length,n=Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a.combine(n,function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return p(function(){return e[i].apply(e,n)})})}))},d=function(t){return t instanceof c.Property},v=function(t){return t instanceof c.Stream},y=function(t){},g=function(t){return t instanceof c.Observable?t:c.constant(t)},M=f.curry(function(t,n){return g(n).debounce(t)}),k=c.merge,b=f.curry(function(t,n){return g(n).delay(t)}),w=f.curry(function(t,n){return g(n).map(t)}),P=f.curry(function(t,n){return g(n).flatMap(f.pipe2U(t,g))}),E=f.curry(function(t,n){return g(n).flatMapConcat(f.pipe2U(t,g))}),U=f.curry(function(t,n){return g(n).flatMapErrors(f.pipe2U(t,g))}),A=f.curry(function(t,n){return g(n).flatMapLatest(f.pipe2U(t,g))}),_=f.curry(function(t,n,r){return g(r).scan(t,n)}),q=f.curry(c.interval),x=f.curry(c.later),C=c.never(),R=f.curry(function(t,n){return g(n).onAny((r=t,function(t){var n;return(n=r[t.type])&&n(t.value)}));var r}),I=f.curry(function(t,n){return g(n).sampledBy(t)}),D=f.curry(function(t,n){return g(n).skip(t)}),S=f.curry(function(t,n){return g(n).skipDuplicates(t)}),F=f.curry(function(t,n){return g(n).filter(t)}),V=f.curry(function(t,n){return g(n).take(t)}),j=f.curry(function(t,n){return g(n).takeErrors(t)}),B=f.curry(function(t,n){return g(n).takeUntilBy(t)}),N=function(t){return d(t)?t:v(t)?t.toProperty():c.constant(t)},W=f.curry(function(t,n){return g(n).throttle(t)}),O=f.curry(c.fromEvents),z=f.curry(function(t,n){return g(n).toProperty(function(){return t})}),J=f.pipe2U(z(void 0),a.lift(y)),L=f.pipe2U(w,J),K=f.curry(function(t,n){return g(n).concat(g(t))}),T=S(f.identicalU),G=f.curry(function(n,t){return g(t).filter(function(t){return!n(t)})}),H=function(t){return a.combine([t],f.id)},Q=f.inherit(function(t){c.Property.call(this),this.m=t,this.a=void 0},c.Property,{_onActivation:function(){var n=this,t=n.m;if(t){n.m=null;var r=t(),e=r.ready||r;n.a=r.abort,e.then(function(t){null!==n.a&&(n.a=null,n._emitValue(t),n._emitEnd())},function(t){null!==n.a&&(n.a=null,n._emitError(t),n._emitEnd())})}},_onDeactivation:function(){var t=this.a;t&&(this.a=null,this._emitEnd(),t())}}),X=function(t,n,r){return N(A(function(t){return t?n:r},t))},Y=f.curry(X),Z=f.curry(function(t,n){return X(t,void 0,n)}),$=f.arityN(2,X),tt=f.inherit(function(t){c.Property.call(this),this.d=t,this.s=this.i=0},c.Property,{_onActivation:function(){var e=this;e.i=requestAnimationFrame(function t(n){e.s||(e.s=n);var r=(n-e.s)/e.d;1<r&&(r=1),e._emitValue(r),r<1?e.i=requestAnimationFrame(t):e._emitEnd()})},_onDeactivation:function(){cancelAnimationFrame(this.i)}}),nt="undefined"==typeof window?f.always(C):function(t){return new tt(t)},rt=n.combines,et=c.Stream.prototype,it=f.inherit(function(){c.Stream.call(this)},c.Stream,{push:et._emitValue,error:et._emitError,end:et._emitEnd}),ot=m(1,"push"),at=m(1,"error"),ut=m(0,"end"),ct=f.seq,ft=f.seqPartial,lt=a.lift(f.curry(function(t,n){return void 0!==n&&t(n),n})),st=function(t,n){for(var r=0,e=n.length;r<e;++r)t=n[r](t);return t},ht=function(n,t){return N(A(function(t){return st(n,t)},t))},pt=function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return h.iso(function(t){return console.log.apply(console,n.concat([t]))||t},function(t){return console.log.apply(console,n.concat([t,"(set)"]))||t})},mt=u.createContext(f.object0),dt=mt.Provider,vt=mt.Consumer,yt=(0,f.id)(function(t){return u.createElement(dt,{value:t.context},t.children)}),gt=(0,f.id)(function(r){return function(n){return u.createElement(vt,null,function(t){return r(n,t)})}}),Mt=function(n,r){return function(t){r.set(t.target[n])}},kt=function(e,t,i){return u.forwardRef(p(function(t,n){var r=l("value",t)||i&&l(i,t);return r&&(t=h.set("onChange",Ut(r,t.onChange),t)),o.createElement(e,n?h.set("ref",n,t):t)}))},bt=kt("select"),wt=kt("input",0,"checked"),Pt=kt("textarea"),Et=h.collect([h.flatten,h.when(f.isFunction)]),Ut=a.lift(function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var e=Et(n);switch(e.length){case 0:return;case 1:return e[0];default:return function(){for(var t=0,n=e.length;t<n;++t)e[t].apply(e,arguments)}}}),At=function(n){return p(function(t){return t[n]()})},_t=At("preventDefault"),qt=At("stopPropagation"),xt=h.join(" ",[h.flatten,h.when(f.id)]),Ct=a.lift(function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return xt(n)||void 0}),Rt=f.curry(function(e,t){var n=f.inherit(function(t){u.PureComponent.call(this,t)},u.PureComponent,{render:function(){return u.createElement(t,this.props)}});return f.inherit(function(t){u.PureComponent.call(this,t),this.o=s(f.object0,t,e)},u.PureComponent,{componentDidUpdate:function(){var t,n,r=this.o;i(t=r,n=this.o=s(r,this.props,e))&&i(n,t)||this.forceUpdate()},render:function(){return u.createElement(n,this.o)},componentWillUnmount:function(){s(this.o,f.object0,e)}})}),It=Rt(f.always(!1)),Dt=a.lift(JSON.parse),St=a.lift(JSON.stringify),Ft=a.lift(decodeURI),Vt=a.lift(decodeURIComponent),jt=a.lift(encodeURI),Bt=a.lift(encodeURIComponent),Nt=a.lift(Math.abs),Wt=a.lift(Math.acos),Ot=a.lift(Math.acosh),zt=a.lift(Math.asin),Jt=a.lift(Math.asinh),Lt=a.lift(Math.atan),Kt=a.lift(Math.atan2),Tt=a.lift(Math.atanh),Gt=a.lift(Math.cbrt),Ht=a.lift(Math.ceil),Qt=a.lift(Math.clz32),Xt=a.lift(Math.cos),Yt=a.lift(Math.cosh),Zt=a.lift(Math.exp),$t=a.lift(Math.expm1),tn=a.lift(Math.floor),nn=a.lift(Math.fround),rn=a.lift(Math.hypot),en=a.lift(Math.imul),on=a.lift(Math.log),an=a.lift(Math.log10),un=a.lift(Math.log1p),cn=a.lift(Math.log2),fn=a.lift(Math.max),ln=a.lift(Math.min),sn=a.lift(Math.pow),hn=a.lift(Math.round),pn=a.lift(Math.sign),mn=a.lift(Math.sin),dn=a.lift(Math.sinh),vn=a.lift(Math.sqrt),yn=a.lift(Math.tan),gn=a.lift(Math.tanh),Mn=a.lift(Math.trunc),kn=a.lift(String.raw),bn=f.curry(function(n,t){var r=a.combine([t],function(t){return n.set(t)});if(d(r))return r.toProperty(y)}),wn=m(1,"modify"),Pn=m(1,"set"),En=m(0,"remove"),Un=f.curry(function(t,n){return n instanceof r.AbstractMutable?d(H(t))?new r.Join(a.combine([t],function(t){return n.view(t)})):n.view(t):a.combine([t,n],h.get)}),An=f.curry(function(c,f){var l=[];return e(f,_(function(t,n){var r=t.length,e=n.length;if(e===r)return t;for(var i=Math.min(r,e),o=t.slice(0,i),a=e;a<r;++a)l[a]._onDeactivation();for(var u=i;u<e;++u)o[u]=c(l[u]=Un(u,f),u);return l.length=e,o},[]),T)}),_n=f.curry(function(t,u,c){var f=new Map,l=h.get(t),s=function(t,n,r){return l(t)===r.id};return e(c,_(function(t,n){for(var r=n.length,e=t.length===r?t:Array(r),i=0;i<r;++i){var o=l(n[i]),a=f.get(o);void 0===a&&(f.set(o,a={}),a.id=o,a.hint=i,a.elem=u(a.view=Un(h.find(s,a),c),o)),e[i]!==a.elem&&(a.hint=i,e===t&&(e=e.slice(0)),e[i]=a.elem)}return e!==t&&f.forEach(function(t,n){e[t.hint]!==t.elem&&(t.view._onDeactivation(),f.delete(n))}),e},[]),T)});t.holding=r.holding,t.combine=a.combine,t.lift=a.lift,t.liftRec=a.liftRec,t.toKaret=o.fromClass,t.debounce=M,t.changes=function(t){return g(t).changes()},t.serially=function(t){return c.concat(t.map(g))},t.parallel=k,t.delay=b,t.mapValue=w,t.flatMapParallel=P,t.flatMapSerial=E,t.flatMapErrors=U,t.flatMapLatest=A,t.foldPast=_,t.interval=q,t.later=x,t.never=C,t.on=R,t.sampledBy=I,t.skipFirst=D,t.skipDuplicates=S,t.skipUnless=F,t.takeFirst=V,t.takeFirstErrors=j,t.takeUntilBy=B,t.toProperty=N,t.throttle=W,t.fromEvents=O,t.ignoreValues=function(t){return t.ignoreValues()},t.ignoreErrors=function(t){return t.ignoreErrors()},t.startWith=z,t.sink=J,t.consume=L,t.endWith=K,t.lazy=function(t){return N(A(t,N()))},t.skipIdenticals=T,t.skipWhen=G,t.template=H,t.fromPromise=function(t){return new Q(t)},t.ifElse=Y,t.unless=Z,t.when=$,t.cond=function(t){for(var n=arguments.length,r=void 0;n--;){var e=arguments[n];r=1!==e.length?X(e[0],e[1],r):e[0]}return r},t.animationSpan=nt,t.combines=rt,t.Bus=it,t.bus=function(){return new it},t.doPush=ot,t.doError=at,t.doEnd=ut,t.seq=ct,t.seqPartial=ft,t.scope=function(t){return t()},t.tapPartial=lt,t.toPartial=function(e){return a.liftRec(f.arityN(e.length,function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.every(f.isDefined)?e.apply(void 0,n):void 0}))},t.thru=e,t.through=function(){for(var t=arguments.length,n=Array(t),r=!0,e=0;e<t;++e){var i=n[e]=arguments[e];r&&(r=!d(i))}return r?function(t){return st(t,n)}:(n=H(n),function(t){return ht(t,n)})},t.show=function(t){for(var n=arguments.length-1,r=Array(n),e=0;e<n;++e)r[e]=arguments[e];var i=a.combine(r,pt),o=arguments[n];return v(o)?d(i)?c.combine([i,o],h.get):w(h.get(i),o):Un(i,o)},t.onUnmount=function(t){return c.stream(f.always(t)).toProperty(f.always(void 0))},t.Context=yt,t.withContext=gt,t.getProps=function(e){var t=void 0;for(var n in e){if(t)return function(t){var n=t.target;for(var r in e)e[r].set(n[r])};t=Mt(n,e[n])}return t},t.setProps=function(t){var i=void 0,o=void 0;return function(e){o&&(i.offAny(o),i=o=null),e&&(o=function(t){switch(t.type){case"value":var n=t.value;for(var r in n)e[r]=n[r];break;case"error":throw t.value;case"end":i=o=null}},(i=H(t)).onAny(o))}},t.Select=bt,t.Input=wt,t.TextArea=Pt,t.refTo=function(n){return function(t){null!==t&&n.set(t)}},t.actions=Ut,t.preventDefault=_t,t.stopPropagation=qt,t.cns=Ct,t.toReactExcept=Rt,t.toReact=It,t.parse=Dt,t.stringify=St,t.decodeURI=Ft,t.decodeURIComponent=Vt,t.encodeURI=jt,t.encodeURIComponent=Bt,t.abs=Nt,t.acos=Wt,t.acosh=Ot,t.asin=zt,t.asinh=Jt,t.atan=Lt,t.atan2=Kt,t.atanh=Tt,t.cbrt=Gt,t.ceil=Ht,t.clz32=Qt,t.cos=Xt,t.cosh=Yt,t.exp=Zt,t.expm1=$t,t.floor=tn,t.fround=nn,t.hypot=rn,t.imul=en,t.log=on,t.log10=an,t.log1p=un,t.log2=cn,t.max=fn,t.min=ln,t.pow=sn,t.round=hn,t.sign=pn,t.sin=mn,t.sinh=dn,t.sqrt=vn,t.tan=yn,t.tanh=gn,t.trunc=Mn,t.string=kn,t.atom=function(t){return new r.Atom(t)},t.variable=function(){return new r.Atom},t.molecule=function(t){return new r.Molecule(t)},t.set=bn,t.doModify=wn,t.doSet=Pn,t.doRemove=En,t.view=Un,t.mapElems=An,t.mapElemsWithIds=_n,Object.defineProperty(t,"__esModule",{value:!0})});
