!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("kefir.atom"),require("kefir"),require("infestines"),require("partial.lenses"),require("kefir.combines"),require("react")):"function"==typeof define&&define.amd?define(["exports","kefir.atom","kefir","infestines","partial.lenses","kefir.combines","react"],n):n((t.karet=t.karet||{},t.karet.util={}),t.kefir.atom,t.Kefir,t.I,t.L,t.kefir.combines,t.React)}(this,function(t,n,r,e,i,o,u){"use strict";function a(t,n){for(var r=0,e=n.length;r<e;++r)t=n[r](t);return t}function c(t){for(var n=arguments.length,r=void 0,e=1;e<n;++e){var i=arguments[e];r?r.push(i):l(i)?r=[i]:t=i(t)}return r?nt(t,$(r)):t}var f=function(t,n){return e.arityN(t+1,function(t){for(var r=arguments.length,e=Array(r>1?r-1:0),i=1;i<r;i++)e[i-1]=arguments[i];return o.combines(e,function(r){return function(){return t[n].apply(t,r)}})})},l=function(t){return t instanceof r.Property},s=function(t){},h=function(t){return function(t){return t instanceof r.Observable}(t)?t:r.constant(t)},p=e.curry(function(t,n){return h(n).debounce(t)}),y=r.merge,v=e.curry(function(t,n){return h(n).delay(t)}),m=e.curry(function(t,n){return h(n).concat(h(t))}),d=e.curry(function(t,n){return h(n).map(t)}),g=e.curry(function(t,n){return h(n).flatMap(e.pipe2U(t,h))}),M=e.curry(function(t,n){return h(n).flatMapConcat(e.pipe2U(t,h))}),R=e.curry(function(t,n){return h(n).flatMapErrors(e.pipe2U(t,h))}),b=e.curry(function(t,n){return h(n).flatMapLatest(e.pipe2U(t,h))}),k=e.curry(function(t,n,r){return h(r).scan(t,n)}),w=e.curry(r.interval),E=e.curry(r.later),P=r.never(),A=e.curry(function(t,n){return h(n).onAny((r=t,function(t){var n;return(n=r[t.type])&&n(t.value)}));var r}),_=e.curry(function(t,n){return h(n).sampledBy(t)}),x=e.curry(function(t,n){return h(n).skip(t)}),q=e.curry(function(t,n){return h(n).skipDuplicates(t)}),U=q(e.identicalU),D=e.curry(function(t,n){return h(n).filter(t)}),S=e.curry(function(t,n){return h(n).filter(function(n){return!t(n)})}),B=e.curry(function(t,n){return h(n).toProperty(function(){return t})}),C=e.pipe2U(B(void 0),o.lift1(s)),N=e.curry(function(t,n){return h(n).take(t)}),V=e.curry(function(t,n){return h(n).takeErrors(t)}),j=e.curry(function(t,n){return h(n).takeUntilBy(t)}),F=function(t){return h(t).toProperty()},O=e.curry(function(t,n){return h(n).throttle(t)}),W=e.curry(r.fromEvents),z=e.inherit(function(t){r.Property.call(this),this.m=t,this.a=void 0},r.Property,{_onActivation:function(){var t=this,n=t.m;if(n){t.m=null;var r=n(),e=r.ready||r;t.a=r.abort,e.then(function(n){null!==t.a&&(t.a=null,t._emitValue(n),t._emitEnd())},function(n){null!==t.a&&(t.a=null,t._emitError(n),t._emitEnd())})}},_onDeactivation:function(){var t=this.a;t&&(this.a=null,this._emitEnd(),t())}}),I=function(t,n,r){return F(b(function(t){return t?n:r},t))},J=e.curry(I),L=e.curry(function(t,n){return I(t,void 0,n)}),K=e.arityN(2,I),T=r.Stream.prototype,G=e.inherit(function(){r.Stream.call(this)},r.Stream,{push:T._emitValue,error:T._emitError,end:T._emitEnd}),H=f(1,"push"),Q=f(1,"error"),X=f(0,"end"),Y=e.seq,Z=e.seqPartial,$=function(t){return o.combines(t,e.id)},tt=o.liftRec(e.curry(function(t,n){return void 0!==n&&t(n),n})),nt=function(t,n){return F(b(function(n){return a(t,n)},n))},rt=function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return i.iso(function(t){return console.log.apply(console,n.concat([t]))||t},function(t){return console.log.apply(console,n.concat([t,"(set)"]))||t})},et=u.createContext(e.object0),it=et.Provider,ot=et.Consumer,ut=(0,e.id)(function(t){return u.createElement(it,{value:t.context},t.children)}),at=(0,e.id)(function(t){return function(n){return u.createElement(ot,null,function(r){return t(n,r)})}}),ct=o.liftRec(function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return function(){for(var t=0,r=n.length;t<r;++t)e.isFunction(n[t])&&n[t].apply(n,arguments)}}),ft=function(t){return function(n){return n[t]()}},lt=ft("preventDefault"),st=ft("stopPropagation"),ht=i.join(" ",[i.flatten,i.when(e.id)]),pt=o.liftRec(function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return ht(n)||void 0}),yt=o.liftRec(JSON.parse),vt=o.liftRec(JSON.stringify),mt=o.liftRec(Math.abs),dt=o.liftRec(Math.acos),gt=o.liftRec(Math.acosh),Mt=o.liftRec(Math.asin),Rt=o.liftRec(Math.asinh),bt=o.liftRec(Math.atan),kt=o.liftRec(Math.atan2),wt=o.liftRec(Math.atanh),Et=o.liftRec(Math.cbrt),Pt=o.liftRec(Math.ceil),At=o.liftRec(Math.clz32),_t=o.liftRec(Math.cos),xt=o.liftRec(Math.cosh),qt=o.liftRec(Math.exp),Ut=o.liftRec(Math.expm1),Dt=o.liftRec(Math.floor),St=o.liftRec(Math.fround),Bt=o.liftRec(Math.hypot),Ct=o.liftRec(Math.imul),Nt=o.liftRec(Math.log),Vt=o.liftRec(Math.log10),jt=o.liftRec(Math.log1p),Ft=o.liftRec(Math.log2),Ot=o.liftRec(Math.max),Wt=o.liftRec(Math.min),zt=o.liftRec(Math.pow),It=o.liftRec(Math.round),Jt=o.liftRec(Math.sign),Lt=o.liftRec(Math.sin),Kt=o.liftRec(Math.sinh),Tt=o.liftRec(Math.sqrt),Gt=o.liftRec(Math.tan),Ht=o.liftRec(Math.tanh),Qt=o.liftRec(Math.trunc),Xt=o.liftRec(String.raw),Yt=e.curry(function(t,n){var r=o.combines(n,function(n){return t.set(n)});if(l(r))return r.toProperty(s)}),Zt=f(1,"modify"),$t=f(1,"set"),tn=f(0,"remove"),nn=e.curry(function(t,r){return r instanceof n.AbstractMutable?l($(t))?new n.Join(o.combines(t,function(t){return r.view(t)})):r.view(t):o.combines(t,r,i.get)}),rn=e.curry(function(t,n){var r=[];return c(n,k(function(e,i){var o=e.length,u=i.length;if(u===o)return e;for(var a=Math.min(o,u),c=e.slice(0,a),f=u;f<o;++f)r[f]._onDeactivation();for(var l=a;l<u;++l)c[l]=t(r[l]=nn(l,n),l);return r.length=u,c},[]),U)}),en=e.curry(function(t,n,r){var e=new Map,o=i.get(t),u=function(t,n,r){return o(t)===r.id};return c(r,k(function(t,a){for(var c=a.length,f=t.length===c?t:Array(c),l=0;l<c;++l){var s=o(a[l]),h=e.get(s);void 0===h&&(e.set(s,h={}),h.id=s,h.hint=l,h.elem=n(h.view=nn(i.find(u,h),r),s)),f[l]!==h.elem&&(h.hint=l,f===t&&(f=f.slice(0)),f[l]=h.elem)}return f!==t&&e.forEach(function(t,n){f[t.hint]!==t.elem&&(t.view._onDeactivation(),e.delete(n))}),f},[]),U)});t.holding=n.holding,t.combines=o.combines,t.liftRec=o.liftRec,t.debounce=p,t.changes=function(t){return h(t).changes()},t.serially=function(t){return r.concat(t.map(h))},t.parallel=y,t.delay=v,t.endWith=m,t.mapValue=d,t.flatMapParallel=g,t.flatMapSerial=M,t.flatMapErrors=R,t.flatMapLatest=b,t.foldPast=k,t.interval=w,t.later=E,t.lazy=function(t){return F(b(t,F()))},t.never=P,t.on=A,t.sampledBy=_,t.skipFirst=x,t.skipDuplicates=q,t.skipIdenticals=U,t.skipUnless=D,t.skipWhen=S,t.startWith=B,t.sink=C,t.takeFirst=N,t.takeFirstErrors=V,t.takeUntilBy=j,t.toProperty=F,t.throttle=O,t.fromEvents=W,t.ignoreValues=function(t){return t.ignoreValues()},t.ignoreErrors=function(t){return t.ignoreErrors()},t.fromPromise=function(t){return new z(t)},t.ifElse=J,t.unless=L,t.when=K,t.cond=function(t){for(var n=arguments.length,r=void 0;n--;){var e=arguments[n];r=1!==e.length?I(e[0],e[1],r):e[0]}return r},t.Bus=G,t.bus=function(){return new G},t.doPush=H,t.doError=Q,t.doEnd=X,t.seq=Y,t.seqPartial=Z,t.scope=function(t){return t()},t.template=$,t.tapPartial=tt,t.toPartial=function(t){return o.liftRec(e.arityN(t.length,function(){for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return r.every(e.isDefined)?t.apply(void 0,r):void 0}))},t.thru=c,t.through=function(){for(var t=arguments.length,n=Array(t),r=!0,e=0;e<t;++e){var i=n[e]=arguments[e];r&&(r=!l(i))}return r?function(t){return a(t,n)}:(n=$(n),function(t){return nt(t,n)})},t.show=function(t){for(var n=arguments.length-1,r=Array(n+1),e=0;e<n;++e)r[e]=arguments[e];return r[n]=rt,nn(o.combines.apply(null,r),arguments[n])},t.onUnmount=function(t){return r.stream(e.always(t)).toProperty(e.always(void 0))},t.Context=ut,t.withContext=at,t.getProps=function(t){return function(n){var r=n.target;for(var e in t)t[e].set(r[e])}},t.setProps=function(t){var n=void 0,r=void 0;return function(e){r&&(n.offAny(r),n=r=null),e&&(r=function(t){switch(t.type){case"value":var i=t.value;for(var o in i)e[o]=i[o];break;case"error":throw t.value;case"end":n=r=null}},(n=$(t)).onAny(r))}},t.refTo=function(t){return function(n){null!==n&&t.set(n)}},t.actions=ct,t.preventDefault=lt,t.stopPropagation=st,t.cns=pt,t.parse=yt,t.stringify=vt,t.abs=mt,t.acos=dt,t.acosh=gt,t.asin=Mt,t.asinh=Rt,t.atan=bt,t.atan2=kt,t.atanh=wt,t.cbrt=Et,t.ceil=Pt,t.clz32=At,t.cos=_t,t.cosh=xt,t.exp=qt,t.expm1=Ut,t.floor=Dt,t.fround=St,t.hypot=Bt,t.imul=Ct,t.log=Nt,t.log10=Vt,t.log1p=jt,t.log2=Ft,t.max=Ot,t.min=Wt,t.pow=zt,t.round=It,t.sign=Jt,t.sin=Lt,t.sinh=Kt,t.sqrt=Tt,t.tan=Gt,t.tanh=Ht,t.trunc=Qt,t.string=Xt,t.atom=function(t){return new n.Atom(t)},t.variable=function(){return new n.Atom},t.molecule=function(t){return new n.Molecule(t)},t.set=Yt,t.doModify=Zt,t.doSet=$t,t.doRemove=tn,t.view=nn,t.mapElems=rn,t.mapElemsWithIds=en,Object.defineProperty(t,"__esModule",{value:!0})});
