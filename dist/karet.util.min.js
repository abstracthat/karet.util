!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("kefir.atom"),require("kefir"),require("infestines"),require("partial.lenses"),require("kefir.combines"),require("react")):"function"==typeof define&&define.amd?define(["exports","kefir.atom","kefir","infestines","partial.lenses","kefir.combines","react"],r):r((t.karet=t.karet||{},t.karet.util={}),t.kefir.atom,t.Kefir,t.I,t.L,t.kefir.combines,t.React)}(this,function(t,r,n,e,i,o,u){"use strict";function c(t,r){for(var n=0,e=r.length;n<e;++n)t=r[n](t);return t}function a(t){for(var r=arguments.length,n=void 0,e=1;e<r;++e){var i=arguments[e];n?n.push(i):l(i)?n=[i]:t=i(t)}return n?tt(t,Z(n)):t}var f=function(t,r){return e.arityN(t+1,function(t){for(var n=arguments.length,e=Array(n>1?n-1:0),i=1;i<n;i++)e[i-1]=arguments[i];return o.combines(e,function(n){return function(){return t[r].apply(t,n)}})})},l=function(t){return t instanceof n.Property},s=function(t){},h=function(t){return function(t){return t instanceof n.Observable}(t)?t:n.constant(t)},p=e.curry(function(t,r){return h(r).debounce(t)}),y=n.merge,v=e.curry(function(t,r){return h(r).delay(t)}),d=e.curry(function(t,r){return h(r).concat(h(t))}),m=e.curry(function(t,r){return h(r).map(t)}),g=e.curry(function(t,r){return h(r).flatMap(e.pipe2U(t,h))}),M=e.curry(function(t,r){return h(r).flatMapConcat(e.pipe2U(t,h))}),R=e.curry(function(t,r){return h(r).flatMapErrors(e.pipe2U(t,h))}),b=e.curry(function(t,r){return h(r).flatMapLatest(e.pipe2U(t,h))}),k=e.curry(function(t,r,n){return h(n).scan(t,r)}),w=e.curry(n.interval),P=e.curry(n.later),E=n.never(),A=e.curry(function(t,r){return h(r).onAny((n=t,function(t){var r;return(r=n[t.type])&&r(t.value)}));var n}),x=e.curry(function(t,r){return h(r).sampledBy(t)}),q=e.curry(function(t,r){return h(r).skip(t)}),U=e.curry(function(t,r){return h(r).skipDuplicates(t)}),S=U(e.identicalU),D=e.curry(function(t,r){return h(r).filter(t)}),_=e.curry(function(t,r){return h(r).filter(function(r){return!t(r)})}),B=e.curry(function(t,r){return h(r).toProperty(function(){return t})}),C=e.pipe2U(B(void 0),o.lift1(s)),N=e.curry(function(t,r){return h(r).take(t)}),j=e.curry(function(t,r){return h(r).takeErrors(t)}),F=e.curry(function(t,r){return h(r).takeUntilBy(t)}),O=function(t){return h(t).toProperty()},V=e.curry(function(t,r){return h(r).throttle(t)}),W=e.curry(n.fromEvents),z=function(t,r,n){return O(b(function(t){return t?r:n},t))},I=e.curry(z),J=e.curry(function(t,r){return z(t,void 0,r)}),L=e.arityN(2,z),K=n.Stream.prototype,T=e.inherit(function(){n.Stream.call(this)},n.Stream,{push:K._emitValue,error:K._emitError,end:K._emitEnd}),G=f(1,"push"),H=f(1,"error"),Q=f(0,"end"),X=e.seq,Y=e.seqPartial,Z=function(t){return o.combines(t,e.id)},$=o.liftRec(e.curry(function(t,r){return void 0!==r&&t(r),r})),tt=function(t,r){return O(b(function(r){return c(t,r)},r))},rt=function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return i.iso(function(t){return console.log.apply(console,r.concat([t]))||t},function(t){return console.log.apply(console,r.concat([t,"(set)"]))||t})},nt=u.createContext(e.object0),et=nt.Provider,it=nt.Consumer,ot=(0,e.id)(function(t){return u.createElement(et,{value:t.context},t.children)}),ut=(0,e.id)(function(t){return function(r){return u.createElement(it,null,function(n){return t(r,n)})}}),ct=o.liftRec(function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return function(){for(var t=0,n=r.length;t<n;++t)e.isFunction(r[t])&&r[t].apply(r,arguments)}}),at=function(t){return function(r){return r[t]()}},ft=at("preventDefault"),lt=at("stopPropagation"),st=i.join(" ",[i.flatten,i.when(e.id)]),ht=o.liftRec(function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return st(r)||void 0}),pt=o.liftRec(JSON.parse),yt=o.liftRec(JSON.stringify),vt=o.liftRec(Math.abs),dt=o.liftRec(Math.acos),mt=o.liftRec(Math.acosh),gt=o.liftRec(Math.asin),Mt=o.liftRec(Math.asinh),Rt=o.liftRec(Math.atan),bt=o.liftRec(Math.atan2),kt=o.liftRec(Math.atanh),wt=o.liftRec(Math.cbrt),Pt=o.liftRec(Math.ceil),Et=o.liftRec(Math.clz32),At=o.liftRec(Math.cos),xt=o.liftRec(Math.cosh),qt=o.liftRec(Math.exp),Ut=o.liftRec(Math.expm1),St=o.liftRec(Math.floor),Dt=o.liftRec(Math.fround),_t=o.liftRec(Math.hypot),Bt=o.liftRec(Math.imul),Ct=o.liftRec(Math.log),Nt=o.liftRec(Math.log10),jt=o.liftRec(Math.log1p),Ft=o.liftRec(Math.log2),Ot=o.liftRec(Math.max),Vt=o.liftRec(Math.min),Wt=o.liftRec(Math.pow),zt=o.liftRec(Math.round),It=o.liftRec(Math.sign),Jt=o.liftRec(Math.sin),Lt=o.liftRec(Math.sinh),Kt=o.liftRec(Math.sqrt),Tt=o.liftRec(Math.tan),Gt=o.liftRec(Math.tanh),Ht=o.liftRec(Math.trunc),Qt=o.liftRec(String.raw),Xt=e.curry(function(t,r){var n=o.combines(r,function(r){return t.set(r)});if(l(n))return n.toProperty(s)}),Yt=f(1,"modify"),Zt=f(1,"set"),$t=f(0,"remove"),tr=e.curry(function(t,n){return n instanceof r.AbstractMutable?l(Z(t))?new r.Join(o.combines(t,function(t){return n.view(t)})):n.view(t):o.combines(t,n,i.get)}),rr=e.curry(function(t,r){var n=[];return a(r,k(function(e,i){var o=e.length,u=i.length;if(u===o)return e;for(var c=Math.min(o,u),a=e.slice(0,c),f=u;f<o;++f)n[f]._onDeactivation();for(var l=c;l<u;++l)a[l]=t(n[l]=tr(l,r),l);return n.length=u,a},[]),S)}),nr=e.curry(function(t,r,n){var e=new Map,o=i.get(t),u=function(t,r,n){return o(t)===n.id};return a(n,k(function(t,c){for(var a=c.length,f=t.length===a?t:Array(a),l=0;l<a;++l){var s=o(c[l]),h=e.get(s);void 0===h&&(e.set(s,h={}),h.id=s,h.hint=l,h.elem=r(h.view=tr(i.find(u,h),n),s)),f[l]!==h.elem&&(h.hint=l,f===t&&(f=f.slice(0)),f[l]=h.elem)}return f!==t&&e.forEach(function(t,r){f[t.hint]!==t.elem&&(t.view._onDeactivation(),e.delete(r))}),f},[]),S)});t.holding=r.holding,t.combines=o.combines,t.liftRec=o.liftRec,t.debounce=p,t.changes=function(t){return h(t).changes()},t.serially=function(t){return n.concat(t.map(h))},t.parallel=y,t.delay=v,t.endWith=d,t.mapValue=m,t.flatMapParallel=g,t.flatMapSerial=M,t.flatMapErrors=R,t.flatMapLatest=b,t.foldPast=k,t.interval=w,t.later=P,t.lazy=function(t){return O(b(t,O()))},t.never=E,t.on=A,t.sampledBy=x,t.skipFirst=q,t.skipDuplicates=U,t.skipIdenticals=S,t.skipUnless=D,t.skipWhen=_,t.startWith=B,t.sink=C,t.takeFirst=N,t.takeFirstErrors=j,t.takeUntilBy=F,t.toProperty=O,t.throttle=V,t.fromEvents=W,t.ignoreValues=function(t){return t.ignoreValues()},t.ignoreErrors=function(t){return t.ignoreErrors()},t.ifElse=I,t.unless=J,t.when=L,t.cond=function(t){for(var r=arguments.length,n=void 0;r--;){var e=arguments[r];n=1!==e.length?z(e[0],e[1],n):e[0]}return n},t.Bus=T,t.bus=function(){return new T},t.doPush=G,t.doError=H,t.doEnd=Q,t.seq=X,t.seqPartial=Y,t.scope=function(t){return t()},t.template=Z,t.tapPartial=$,t.toPartial=function(t){return o.liftRec(e.arityN(t.length,function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return n.every(e.isDefined)?t.apply(void 0,n):void 0}))},t.thru=a,t.through=function(){for(var t=arguments.length,r=Array(t),n=!0,e=0;e<t;++e){var i=r[e]=arguments[e];n&&(n=!l(i))}return n?function(t){return c(t,r)}:(r=Z(r),function(t){return tt(t,r)})},t.show=function(t){for(var r=arguments.length-1,n=Array(r+1),e=0;e<r;++e)n[e]=arguments[e];return n[r]=rt,tr(o.combines.apply(null,n),arguments[r])},t.onUnmount=function(t){return n.stream(e.always(t)).toProperty(e.always(void 0))},t.Context=ot,t.withContext=ut,t.getProps=function(t){return function(r){var n=r.target;for(var e in t)t[e].set(n[e])}},t.setProps=function(t){var r=void 0,n=void 0;return function(e){n&&(r.offAny(n),r=n=null),e&&(n=function(t){switch(t.type){case"value":var i=t.value;for(var o in i)e[o]=i[o];break;case"error":throw t.value;case"end":r=n=null}},(r=Z(t)).onAny(n))}},t.refTo=function(t){return function(r){null!==r&&t.set(r)}},t.actions=ct,t.preventDefault=ft,t.stopPropagation=lt,t.cns=ht,t.parse=pt,t.stringify=yt,t.abs=vt,t.acos=dt,t.acosh=mt,t.asin=gt,t.asinh=Mt,t.atan=Rt,t.atan2=bt,t.atanh=kt,t.cbrt=wt,t.ceil=Pt,t.clz32=Et,t.cos=At,t.cosh=xt,t.exp=qt,t.expm1=Ut,t.floor=St,t.fround=Dt,t.hypot=_t,t.imul=Bt,t.log=Ct,t.log10=Nt,t.log1p=jt,t.log2=Ft,t.max=Ot,t.min=Vt,t.pow=Wt,t.round=zt,t.sign=It,t.sin=Jt,t.sinh=Lt,t.sqrt=Kt,t.tan=Tt,t.tanh=Gt,t.trunc=Ht,t.string=Qt,t.atom=function(t){return new r.Atom(t)},t.variable=function(){return new r.Atom},t.molecule=function(t){return new r.Molecule(t)},t.set=Xt,t.doModify=Yt,t.doSet=Zt,t.doRemove=$t,t.view=tr,t.mapElems=rr,t.mapElemsWithIds=nr,Object.defineProperty(t,"__esModule",{value:!0})});
