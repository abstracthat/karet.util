!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("kefir.atom"),require("kefir"),require("infestines"),require("partial.lenses"),require("karet.lift"),require("karet"),require("react"),require("kefir.combines")):"function"==typeof define&&define.amd?define(["exports","kefir.atom","kefir","infestines","partial.lenses","karet.lift","karet","react","kefir.combines"],n):n((t.karet=t.karet||{},t.karet.util={}),t.kefir.atom,t.Kefir,t.I,t.L,t.karet.lift,t.karet,t.React,t.kefir.combines)}(this,function(t,r,a,o,h,u,c,f,n){"use strict";function e(t){for(var n=arguments.length,r=void 0,e=1;e<n;++e){var i=arguments[e];r?r.push(i):p(i)?r=[i]:t=i(t)}return r?lt(t,K(r)):t}function l(t,n){var r,e=n[t];if(null!=(r=e)&&o.isFunction(r.set))return yt(t,e)}var s=function(t){return t},i=function(t,i,n){return o.arityN(t+1,s(function(e){for(var t=arguments.length,n=Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return u.combine(n,function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return s(function(){return e[i].apply(e,n)})})}))},p=function(t){return t instanceof a.Property},d=function(t){return t instanceof a.Stream},m=function(t){},v=function(t){return t instanceof a.Observable?t:a.constant(t)},y=o.curry(function(t,n){return v(n).debounce(t)}),g=a.merge,M=o.curry(function(t,n){return v(n).delay(t)}),k=o.curry(function(t,n){return v(n).map(t)}),b=o.curry(function(t,n){return v(n).flatMap(o.pipe2U(t,v))}),w=o.curry(function(t,n){return v(n).flatMapConcat(o.pipe2U(t,v))}),E=o.curry(function(t,n){return v(n).flatMapErrors(o.pipe2U(t,v))}),P=o.curry(function(t,n){return v(n).flatMapLatest(o.pipe2U(t,v))}),A=o.curry(function(t,n,r){return v(r).scan(t,n)}),U=o.curry(a.interval),_=o.curry(a.later),q=a.never(),x=o.curry(function(t,n){return v(n).onAny((r=t,function(t){var n;return(n=r[t.type])&&n(t.value)}));var r}),R=o.curry(function(t,n){return v(n).sampledBy(t)}),I=o.curry(function(t,n){return v(n).skip(t)}),C=o.curry(function(t,n){return v(n).skipDuplicates(t)}),S=o.curry(function(t,n){return v(n).filter(t)}),D=o.curry(function(t,n){return v(n).take(t)}),F=o.curry(function(t,n){return v(n).takeErrors(t)}),V=o.curry(function(t,n){return v(n).takeUntilBy(t)}),B=function(t){return p(t)?t:d(t)?t.toProperty():a.constant(t)},N=o.curry(function(t,n){return v(n).throttle(t)}),j=o.curry(a.fromEvents),O=o.curry(function(t,n){return v(n).toProperty(function(){return t})}),W=o.pipe2U(O(void 0),u.lift(m)),z=o.pipe2U(k,W),J=o.curry(function(t,n){return v(n).concat(v(t))}),L=C(o.identicalU),T=o.curry(function(n,t){return v(t).filter(function(t){return!n(t)})}),K=function(t){return u.combine([t],o.id)},G=o.inherit(function(t){a.Property.call(this),this.m=t,this.a=void 0},a.Property,{_onActivation:function(){var n=this,t=n.m;if(t){n.m=null;var r=t(),e=r.ready||r;n.a=r.abort,e.then(function(t){null!==n.a&&(n.a=null,n._emitValue(t),n._emitEnd())},function(t){null!==n.a&&(n.a=null,n._emitError(t),n._emitEnd())})}},_onDeactivation:function(){var t=this.a;t&&(this.a=null,this._emitEnd(),t())}}),H=function(t,n,r){return B(P(function(t){return t?n:r},t))},Q=o.curry(H),X=o.curry(function(t,n){return H(t,void 0,n)}),Y=o.arityN(2,H),Z=o.inherit(function(t){a.Property.call(this),this.d=t,this.s=this.i=0},a.Property,{_onActivation:function(){var e=this;e.i=requestAnimationFrame(function t(n){e.s||(e.s=n);var r=(n-e.s)/e.d;1<r&&(r=1),e._emitValue(r),r<1?e.i=requestAnimationFrame(t):e._emitEnd()})},_onDeactivation:function(){cancelAnimationFrame(this.i)}}),$="undefined"==typeof window?o.always(q):function(t){return new Z(t)},tt=n.combines,nt=a.Stream.prototype,rt=o.inherit(function(){a.Stream.call(this)},a.Stream,{push:nt._emitValue,error:nt._emitError,end:nt._emitEnd}),et=i(1,"push"),it=i(1,"error"),ot=i(0,"end"),at=o.seq,ut=o.seqPartial,ct=u.lift(o.curry(function(t,n){return void 0!==n&&t(n),n})),ft=function(t,n){for(var r=0,e=n.length;r<e;++r)t=n[r](t);return t},lt=function(n,t){return B(P(function(t){return ft(n,t)},t))},st=function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return h.iso(function(t){return console.log.apply(console,n.concat([t]))||t},function(t){return console.log.apply(console,n.concat([t,"(set)"]))||t})},ht=f.createContext(o.object0),pt=ht.Provider,dt=ht.Consumer,mt=(0,o.id)(function(t){return f.createElement(pt,{value:t.context},t.children)}),vt=(0,o.id)(function(r){return function(n){return f.createElement(dt,null,function(t){return r(n,t)})}}),yt=function(n,r){return function(t){r.set(t.target[n])}},gt=function(e,t,i){return f.forwardRef(s(function(t,n){var r=l("value",t)||i&&l(i,t);return r&&(t=h.set("onChange",Et(r,t.onChange),t)),c.createElement(e,n?h.set("ref",n,t):t)}))},Mt=gt("select"),kt=gt("input",0,"checked"),bt=gt("textarea"),wt=h.collect([h.flatten,h.when(o.isFunction)]),Et=u.lift(function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var e=wt(n);switch(e.length){case 0:return;case 1:return e[0];default:return function(){for(var t=0,n=e.length;t<n;++t)e[t].apply(e,arguments)}}}),Pt=function(n){return s(function(t){return t[n]()})},At=Pt("preventDefault"),Ut=Pt("stopPropagation"),_t=h.join(" ",[h.flatten,h.when(o.id)]),qt=u.lift(function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return _t(n)||void 0}),xt=u.lift(JSON.parse),Rt=u.lift(JSON.stringify),It=u.lift(decodeURI),Ct=u.lift(decodeURIComponent),St=u.lift(encodeURI),Dt=u.lift(encodeURIComponent),Ft=u.lift(Math.abs),Vt=u.lift(Math.acos),Bt=u.lift(Math.acosh),Nt=u.lift(Math.asin),jt=u.lift(Math.asinh),Ot=u.lift(Math.atan),Wt=u.lift(Math.atan2),zt=u.lift(Math.atanh),Jt=u.lift(Math.cbrt),Lt=u.lift(Math.ceil),Tt=u.lift(Math.clz32),Kt=u.lift(Math.cos),Gt=u.lift(Math.cosh),Ht=u.lift(Math.exp),Qt=u.lift(Math.expm1),Xt=u.lift(Math.floor),Yt=u.lift(Math.fround),Zt=u.lift(Math.hypot),$t=u.lift(Math.imul),tn=u.lift(Math.log),nn=u.lift(Math.log10),rn=u.lift(Math.log1p),en=u.lift(Math.log2),on=u.lift(Math.max),an=u.lift(Math.min),un=u.lift(Math.pow),cn=u.lift(Math.round),fn=u.lift(Math.sign),ln=u.lift(Math.sin),sn=u.lift(Math.sinh),hn=u.lift(Math.sqrt),pn=u.lift(Math.tan),dn=u.lift(Math.tanh),mn=u.lift(Math.trunc),vn=u.lift(String.raw),yn=o.curry(function(n,t){var r=u.combine([t],function(t){return n.set(t)});if(p(r))return r.toProperty(m)}),gn=i(1,"modify"),Mn=i(1,"set"),kn=i(0,"remove"),bn=o.curry(function(t,n){return n instanceof r.AbstractMutable?p(K(t))?new r.Join(u.combine([t],function(t){return n.view(t)})):n.view(t):u.combine([t,n],h.get)}),wn=o.curry(function(c,f){var l=[];return e(f,A(function(t,n){var r=t.length,e=n.length;if(e===r)return t;for(var i=Math.min(r,e),o=t.slice(0,i),a=e;a<r;++a)l[a]._onDeactivation();for(var u=i;u<e;++u)o[u]=c(l[u]=bn(u,f),u);return l.length=e,o},[]),L)}),En=o.curry(function(t,u,c){var f=new Map,l=h.get(t),s=function(t,n,r){return l(t)===r.id};return e(c,A(function(t,n){for(var r=n.length,e=t.length===r?t:Array(r),i=0;i<r;++i){var o=l(n[i]),a=f.get(o);void 0===a&&(f.set(o,a={}),a.id=o,a.hint=i,a.elem=u(a.view=bn(h.find(s,a),c),o)),e[i]!==a.elem&&(a.hint=i,e===t&&(e=e.slice(0)),e[i]=a.elem)}return e!==t&&f.forEach(function(t,n){e[t.hint]!==t.elem&&(t.view._onDeactivation(),f.delete(n))}),e},[]),L)});t.holding=r.holding,t.combine=u.combine,t.lift=u.lift,t.liftRec=u.liftRec,t.debounce=y,t.changes=function(t){return v(t).changes()},t.serially=function(t){return a.concat(t.map(v))},t.parallel=g,t.delay=M,t.mapValue=k,t.flatMapParallel=b,t.flatMapSerial=w,t.flatMapErrors=E,t.flatMapLatest=P,t.foldPast=A,t.interval=U,t.later=_,t.never=q,t.on=x,t.sampledBy=R,t.skipFirst=I,t.skipDuplicates=C,t.skipUnless=S,t.takeFirst=D,t.takeFirstErrors=F,t.takeUntilBy=V,t.toProperty=B,t.throttle=N,t.fromEvents=j,t.ignoreValues=function(t){return t.ignoreValues()},t.ignoreErrors=function(t){return t.ignoreErrors()},t.startWith=O,t.sink=W,t.consume=z,t.endWith=J,t.lazy=function(t){return B(P(t,B()))},t.skipIdenticals=L,t.skipWhen=T,t.template=K,t.fromPromise=function(t){return new G(t)},t.ifElse=Q,t.unless=X,t.when=Y,t.cond=function(t){for(var n=arguments.length,r=void 0;n--;){var e=arguments[n];r=1!==e.length?H(e[0],e[1],r):e[0]}return r},t.animationSpan=$,t.combines=tt,t.Bus=rt,t.bus=function(){return new rt},t.doPush=et,t.doError=it,t.doEnd=ot,t.seq=at,t.seqPartial=ut,t.scope=function(t){return t()},t.tapPartial=ct,t.toPartial=function(e){return u.liftRec(o.arityN(e.length,function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.every(o.isDefined)?e.apply(void 0,n):void 0}))},t.thru=e,t.through=function(){for(var t=arguments.length,n=Array(t),r=!0,e=0;e<t;++e){var i=n[e]=arguments[e];r&&(r=!p(i))}return r?function(t){return ft(t,n)}:(n=K(n),function(t){return lt(t,n)})},t.show=function(t){for(var n=arguments.length-1,r=Array(n),e=0;e<n;++e)r[e]=arguments[e];var i=u.combine(r,st),o=arguments[n];return d(o)?p(i)?a.combine([i,o],h.get):k(h.get(i),o):bn(i,o)},t.onUnmount=function(t){return a.stream(o.always(t)).toProperty(o.always(void 0))},t.Context=mt,t.withContext=vt,t.getProps=function(e){var t=void 0;for(var n in e){if(t)return function(t){var n=t.target;for(var r in e)e[r].set(n[r])};t=yt(n,e[n])}return t},t.setProps=function(t){var i=void 0,o=void 0;return function(e){o&&(i.offAny(o),i=o=null),e&&(o=function(t){switch(t.type){case"value":var n=t.value;for(var r in n)e[r]=n[r];break;case"error":throw t.value;case"end":i=o=null}},(i=K(t)).onAny(o))}},t.Select=Mt,t.Input=kt,t.TextArea=bt,t.refTo=function(n){return function(t){null!==t&&n.set(t)}},t.actions=Et,t.preventDefault=At,t.stopPropagation=Ut,t.cns=qt,t.parse=xt,t.stringify=Rt,t.decodeURI=It,t.decodeURIComponent=Ct,t.encodeURI=St,t.encodeURIComponent=Dt,t.abs=Ft,t.acos=Vt,t.acosh=Bt,t.asin=Nt,t.asinh=jt,t.atan=Ot,t.atan2=Wt,t.atanh=zt,t.cbrt=Jt,t.ceil=Lt,t.clz32=Tt,t.cos=Kt,t.cosh=Gt,t.exp=Ht,t.expm1=Qt,t.floor=Xt,t.fround=Yt,t.hypot=Zt,t.imul=$t,t.log=tn,t.log10=nn,t.log1p=rn,t.log2=en,t.max=on,t.min=an,t.pow=un,t.round=cn,t.sign=fn,t.sin=ln,t.sinh=sn,t.sqrt=hn,t.tan=pn,t.tanh=dn,t.trunc=mn,t.string=vn,t.atom=function(t){return new r.Atom(t)},t.variable=function(){return new r.Atom},t.molecule=function(t){return new r.Molecule(t)},t.set=yn,t.doModify=gn,t.doSet=Mn,t.doRemove=kn,t.view=bn,t.mapElems=wn,t.mapElemsWithIds=En,Object.defineProperty(t,"__esModule",{value:!0})});
